<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 9 Unequal-variance SDT | RHUL Psychology Statistical modelling notebook</title>
<meta name="author" content="Matteo Lisi">
<meta name="description" content="Signal detection theory can be extended to account for cases in which signal and noise distribution have a different variance. For many types of random processes, the mean and the variance are...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content=" 9 Unequal-variance SDT | RHUL Psychology Statistical modelling notebook">
<meta property="og:type" content="book">
<meta property="og:url" content="https://mlisi.xyz/RHUL-stats/unequal-variance-sdt.html">
<meta property="og:image" content="https://mlisi.xyz/RHUL-stats/images/bull_picasso.jpg">
<meta property="og:description" content="Signal detection theory can be extended to account for cases in which signal and noise distribution have a different variance. For many types of random processes, the mean and the variance are...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 9 Unequal-variance SDT | RHUL Psychology Statistical modelling notebook">
<meta name="twitter:description" content="Signal detection theory can be extended to account for cases in which signal and noise distribution have a different variance. For many types of random processes, the mean and the variance are...">
<meta name="twitter:image" content="https://mlisi.xyz/RHUL-stats/images/bull_picasso.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">RHUL Psychology
Statistical modelling notebook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li><a class="" href="surveys.html"><span class="header-section-number">2</span> Departmental survey about statistical methods</a></li>
<li><a class="" href="intro-R.html"><span class="header-section-number">3</span> Introduction to R</a></li>
<li><a class="" href="linear-models.html"><span class="header-section-number">4</span> Linear models</a></li>
<li><a class="" href="count-data.html"><span class="header-section-number">5</span> Models for count data</a></li>
<li><a class="" href="meta-analysis.html"><span class="header-section-number">6</span> Meta-analyses</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">7</span> Missing data</a></li>
<li><a class="" href="SDT.html"><span class="header-section-number">8</span> Signal Detection Theory</a></li>
<li><a class="active" href="unequal-variance-sdt.html"><span class="header-section-number">9</span> Unequal-variance SDT</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mattelisi/RHUL-stats">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="unequal-variance-sdt" class="section level1" number="9">
<h1>
<span class="header-section-number"> 9</span> Unequal-variance SDT<a class="anchor" aria-label="anchor" href="#unequal-variance-sdt"><i class="fas fa-link"></i></a>
</h1>
<p>Signal detection theory can be extended to account for cases in which signal and noise distribution have a different variance. For many types of random processes, the mean and the variance are related such that signals with higher mean have also higher variance (the firing rate of neurons is an example). Thus the signal distribution is now given by
<span class="math display">\[
f_S(x)=\frac{1}{\sigma\sqrt{2 \pi}} e^{-\frac{(x-d')^2}{2 \sigma^2}}
\]</span>
with the variance <span class="math inline">\(\sigma^2 \ne 1\)</span>.</p>
<p>One important consequence of the different noise level, is that now the log-likelihood ratio is a quadratic function of the signal x</p>
<p><span class="math display">\[
\log \left( \frac{f_S(x)}{f_N(x)} \right) = -\frac{1}{2 \sigma^2} \left[\left(1 - \sigma^2 \right)x^2 -2d' x + d'^2 + 2\sigma^2 \log \sigma\right]
\]</span>
As a result, the log-likelihood ratio crosses zero in 2 points, thus yielding 2 decision criteria.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># settings</span></span>
<span><span class="va">d_prime</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">sigmaS</span> <span class="op">&lt;-</span> <span class="fl">2</span>  </span>
<span><span class="va">sigmaN</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># fixed</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span></span>
<span><span class="co"># calculate optimal UEV-SDT criterion</span></span>
<span><span class="va">UVGSDTcrit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dp</span>, <span class="va">sig</span>, <span class="va">logbeta</span><span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">TwoSigSq</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">sig</span><span class="op">^</span><span class="fl">2</span></span>
<span>  </span>
<span>  <span class="va">minLam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optimize.html">optimize</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">dp</span>, <span class="va">sig</span><span class="op">)</span><span class="op">{</span><span class="op">-</span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">sig</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">X</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">dp</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="va">dp</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">TwoSigSq</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">sig</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">TwoSigSq</span><span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, dp <span class="op">=</span> <span class="va">dp</span>, sig <span class="op">=</span> <span class="va">sig</span><span class="op">)</span><span class="op">$</span><span class="va">objective</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">logbeta</span> <span class="op">&lt;</span> <span class="va">minLam</span><span class="op">)</span><span class="op">{</span> <span class="kw"><a href="https://rdrr.io/r/base/warning.html">warning</a></span><span class="op">(</span><span class="st">"complex roots"</span><span class="op">)</span><span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">cf</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dp</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">TwoSigSq</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">sig</span><span class="op">)</span> <span class="op">+</span> <span class="va">logbeta</span> <span class="op">*</span> <span class="va">TwoSigSq</span>,<span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="va">dp</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">sig</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="va">TwoSigSq</span></span>
<span>  </span>
<span>  <span class="va">proot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/polyroot.html">polyroot</a></span><span class="op">(</span><span class="va">cf</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html">Re</a></span><span class="op">(</span><span class="va">proot</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#</span></span>
<span><span class="va">UE_c</span> <span class="op">&lt;-</span> <span class="fu">UVGSDTcrit</span><span class="op">(</span><span class="va">d_prime</span>, <span class="va">sigmaS</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate 2*10^3 trials and calculate the confidence </span></span>
<span><span class="va">N_trials</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fl">10</span><span class="op">^</span><span class="fl">3</span></span>
<span><span class="va">tar_pres</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">N_trials</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">N_trials</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate X by adding Gaussian noise (function rnorm())</span></span>
<span><span class="co"># first generate internal responses</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">tar_pres</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">tar_pres</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N_trials</span><span class="op">/</span><span class="fl">2</span>, mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">tar_pres</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N_trials</span><span class="op">/</span><span class="fl">2</span>, mean<span class="op">=</span><span class="va">d_prime</span>,sd<span class="op">=</span><span class="va">sigmaS</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># plot unequal variance and criterion</span></span>
<span><span class="va">Xi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">10</span>,length.out<span class="op">=</span><span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">fS</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">Xi</span>,mean<span class="op">=</span><span class="va">d_prime</span>,sd<span class="op">=</span><span class="va">sigmaS</span><span class="op">)</span></span>
<span><span class="va">fN</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">Xi</span>,mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Xi</span>,<span class="va">fN</span>,type<span class="op">=</span><span class="st">"l"</span>,col<span class="op">=</span><span class="st">"grey"</span>,lwd<span class="op">=</span><span class="fl">3</span>,ylab<span class="op">=</span><span class="st">"density"</span>,xlab<span class="op">=</span><span class="st">"X"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Xi</span>,<span class="va">fS</span>,lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">UE_c</span>,col<span class="op">=</span><span class="st">"red"</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="20-SDT_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></div>
<p>The reason why there are two criteria may be seen more clearly if we plot the logarithm of the probability density, as this makes it evident that there are two regions, to the left and the right of the noise distribution, in which the probability of signal present is larger than that of no-signal (i.e noise only).</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot unequal variance and criterion</span></span>
<span><span class="va">Xi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">10</span>,length.out<span class="op">=</span><span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">fS</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">Xi</span>,mean<span class="op">=</span><span class="va">d_prime</span>,sd<span class="op">=</span><span class="va">sigmaS</span><span class="op">)</span></span>
<span><span class="va">fN</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">Xi</span>,mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Xi</span>,<span class="va">fN</span>,type<span class="op">=</span><span class="st">"l"</span>,col<span class="op">=</span><span class="st">"grey"</span>,lwd<span class="op">=</span><span class="fl">3</span>,ylab<span class="op">=</span><span class="st">"density"</span>,xlab<span class="op">=</span><span class="st">"X"</span>, log<span class="op">=</span><span class="st">"y"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Xi</span>,<span class="va">fS</span>,lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">UE_c</span>,col<span class="op">=</span><span class="st">"red"</span>,lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="20-SDT_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></div>
<div id="optimal-confidence-in-unequal-variance-sdt" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Optimal confidence in unequal-variance SDT<a class="anchor" aria-label="anchor" href="#optimal-confidence-in-unequal-variance-sdt"><i class="fas fa-link"></i></a>
</h2>
<p>The confidence can be computed in the same way (applying Bayes rule).</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># now apply decision rule</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">UE_c</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">resp_yes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="va">UE_c</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>  <span class="va">resp_yes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;=</span> <span class="va">UE_c</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">|</span><span class="op">(</span><span class="va">x</span><span class="op">&gt;</span><span class="va">UE_c</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="co"># define a custom function to calculate confidence</span></span>
<span><span class="va">confidenceSDT1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">resp</span>,<span class="va">dp</span><span class="op">=</span><span class="va">d_prime</span>, <span class="va">alpha</span><span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">conf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span></span>
<span>    <span class="va">resp</span><span class="op">==</span><span class="fl">1</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,mean<span class="op">=</span><span class="va">dp</span>,sd<span class="op">=</span><span class="va">sigmaS</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,mean<span class="op">=</span><span class="va">dp</span>,sd<span class="op">=</span><span class="va">sigmaS</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,mean<span class="op">=</span><span class="va">dp</span>,sd<span class="op">=</span><span class="va">sigmaS</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">conf</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># calculate confidence</span></span>
<span><span class="va">confidence</span> <span class="op">&lt;-</span> <span class="fu">confidenceSDT1</span><span class="op">(</span><span class="va">x</span>, <span class="va">resp_yes</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># put into a dataframe for plotting</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">confidence</span>, <span class="va">x</span>, <span class="va">tar_pres</span>, <span class="va">resp_yes</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check which simulated responses are correct</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">correct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">tar_pres</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">d</span><span class="op">$</span><span class="va">resp_yes</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">|</span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">tar_pres</span><span class="op">==</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">d</span><span class="op">$</span><span class="va">resp_yes</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">tar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">tar_pres</span><span class="op">==</span><span class="fl">1</span>,<span class="st">"signal present"</span>,<span class="st">"signal absent"</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">$</span><span class="va">correct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">correct</span><span class="op">==</span><span class="fl">1</span>,<span class="st">" correct response"</span>,<span class="st">"wrong response"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">d</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">confidence</span>,group<span class="op">=</span><span class="va">correct</span>,color<span class="op">=</span><span class="va">correct</span>,fill<span class="op">=</span><span class="va">correct</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span>,bw<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">tar</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dark green"</span>,<span class="st">"red"</span><span class="op">)</span>,name<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dark green"</span>,<span class="st">"red"</span><span class="op">)</span>,name<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"confidence level"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Unequal-variance SDT"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="20-SDT_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></div>
<p>As can be seen from the ROC curve, confidence levels (even estimated optimally using Bayes rule) reveals an asymmetry (again, target present responses are represented by the blue curve).</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># functions to compute true and false positive rates</span></span>
<span><span class="va">TPR</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span>,<span class="va">th</span><span class="op">)</span><span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">tar_pres</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">d</span><span class="op">$</span><span class="va">x</span><span class="op">&gt;</span><span class="va">th</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">tar_pres</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">FPR</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span>,<span class="va">th</span><span class="op">)</span><span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">tar_pres</span><span class="op">==</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">d</span><span class="op">$</span><span class="va">x</span><span class="op">&gt;</span><span class="va">th</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">tar_pres</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="co"># use all the sorted values are possible threshods</span></span>
<span><span class="va">thresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="va">roc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">thresholds</span>, <span class="kw">function</span><span class="op">(</span><span class="va">th</span><span class="op">)</span><span class="op">{</span><span class="fu">TPR</span><span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">d</span><span class="op">$</span><span class="va">resp_yes</span><span class="op">==</span><span class="fl">1</span>,<span class="op">]</span>,<span class="va">th</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>, </span>
<span>                 x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">thresholds</span>, <span class="kw">function</span><span class="op">(</span><span class="va">th</span><span class="op">)</span><span class="op">{</span><span class="fu">FPR</span><span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">d</span><span class="op">$</span><span class="va">resp_yes</span><span class="op">==</span><span class="fl">1</span>,<span class="op">]</span>,<span class="va">th</span><span class="op">)</span><span class="op">}</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="va">roc0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">thresholds</span>, <span class="kw">function</span><span class="op">(</span><span class="va">th</span><span class="op">)</span><span class="op">{</span><span class="fu">TPR</span><span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">d</span><span class="op">$</span><span class="va">resp_yes</span><span class="op">==</span><span class="fl">0</span>,<span class="op">]</span>,<span class="va">th</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>, </span>
<span>                 x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">thresholds</span>, <span class="kw">function</span><span class="op">(</span><span class="va">th</span><span class="op">)</span><span class="op">{</span><span class="fu">FPR</span><span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">d</span><span class="op">$</span><span class="va">resp_yes</span><span class="op">==</span><span class="fl">0</span>,<span class="op">]</span>,<span class="va">th</span><span class="op">)</span><span class="op">}</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">roc</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">"Type-2 hits"</span>, x<span class="op">=</span><span class="st">"Type-2 FA"</span><span class="op">)</span> <span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept<span class="op">=</span><span class="fl">0</span>,slope<span class="op">=</span><span class="fl">1</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">roc0</span>,color<span class="op">=</span><span class="st">"dark red"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Unequal-variance SDT, Type 2 sensitivity"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="20-SDT_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;"></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="SDT.html"><span class="header-section-number">8</span> Signal Detection Theory</a></div>
<div class="next"><a href="references.html">References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#unequal-variance-sdt"><span class="header-section-number">9</span> Unequal-variance SDT</a></li>
<li><a class="nav-link" href="#optimal-confidence-in-unequal-variance-sdt"><span class="header-section-number">9.1</span> Optimal confidence in unequal-variance SDT</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mattelisi/RHUL-stats/blob/main/RHUL-stats-notebook/20-SDT.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mattelisi/RHUL-stats/edit/main/RHUL-stats-notebook/20-SDT.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>RHUL Psychology
Statistical modelling notebook</strong>" was written by Matteo Lisi. It was last built on 2022-08-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
