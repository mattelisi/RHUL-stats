<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 3 Introduction to R | RHUL Psychology Statistical modelling notebook</title>
<meta name="author" content="Matteo Lisi">
<meta name="description" content="Most of the practical statistical tutorials and recipes in this book use the software R, so this section provides some introduction to R for the uninitiated. \[\\[1in]\]  3.1 Installing R The base...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content=" 3 Introduction to R | RHUL Psychology Statistical modelling notebook">
<meta property="og:type" content="book">
<meta property="og:url" content="https://mlisi.xyz/RHUL-stats/intro-R.html">
<meta property="og:image" content="https://mlisi.xyz/RHUL-stats/images/bull_picasso.jpg">
<meta property="og:description" content="Most of the practical statistical tutorials and recipes in this book use the software R, so this section provides some introduction to R for the uninitiated. \[\\[1in]\]  3.1 Installing R The base...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 3 Introduction to R | RHUL Psychology Statistical modelling notebook">
<meta name="twitter:description" content="Most of the practical statistical tutorials and recipes in this book use the software R, so this section provides some introduction to R for the uninitiated. \[\\[1in]\]  3.1 Installing R The base...">
<meta name="twitter:image" content="https://mlisi.xyz/RHUL-stats/images/bull_picasso.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">RHUL Psychology
Statistical modelling notebook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li><a class="" href="surveys.html"><span class="header-section-number">2</span> Departmental survey about statistical methods</a></li>
<li><a class="active" href="intro-R.html"><span class="header-section-number">3</span> Introduction to R</a></li>
<li><a class="" href="meta-analysis.html"><span class="header-section-number">4</span> Meta-analyses</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">5</span> Missing data</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mattelisi/RHUL-stats">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="intro-R" class="section level1" number="3">
<h1>
<span class="header-section-number"> 3</span> Introduction to R<a class="anchor" aria-label="anchor" href="#intro-R"><i class="fas fa-link"></i></a>
</h1>
<p>Most of the practical statistical tutorials and recipes in this book use the software R, so this section provides some introduction to R for the uninitiated.</p>
<hr>
<p><span class="math display">\[\\[1in]\]</span></p>
<div id="installing-r" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Installing R<a class="anchor" aria-label="anchor" href="#installing-r"><i class="fas fa-link"></i></a>
</h2>
<p>The base R system can be downloaded at the following link, which provides installers for both Windows, Mac and Linux:</p>
<p><a href="https://cran.rstudio.com/">https://cran.rstudio.com/</a></p>
<p>In addition to the base R system, it is useful to have also R-studio, which is an IDE (Integrated Development Environment) for R, and provides both an editor, a graphical interface and much more. It can be downloaded from:</p>
<p><a href="https://www.rstudio.com/products/rstudio/download/">https://www.rstudio.com/products/rstudio/download/</a></p>
</div>
<div id="first-steps" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> First steps<a class="anchor" aria-label="anchor" href="#first-steps"><i class="fas fa-link"></i></a>
</h2>
<p>R is a programming language and free software environment for statistical computing and graphics. It is an <em>interpreted language</em>, which means that to give instructions to the computer you do not have to compile it first in machine language, everything is done ‘on the fly’ through a command line interpreter, e.g. if you type <code>2+2</code> in the command line R, the computer will reply with the answer (try this on your computer):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">2</span><span class="op">+</span><span class="fl">2</span>
<span class="co">#&gt; [1] 4</span></code></pre></div>
<p>Typically the normal workflow involve writing and saving a series of instructions in a script file, which can be executed (either step by step or all at once). This makes statistical analyses transparent and reproducible since everyone in possess of the same data and script should be able to obtain the same results.</p>
<p>In an R script you can use the <code>#</code> sign to add comments, so that you and others can understand what the R code is about. Comments are not run as R code, so they will not influence your result. See the next example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate 3 + 4</span>
<span class="fl">3</span> <span class="op">+</span> <span class="fl">4</span>
<span class="co">#&gt; [1] 7</span></code></pre></div>
<div id="arithmetic-with-r" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Arithmetic with R<a class="anchor" aria-label="anchor" href="#arithmetic-with-r"><i class="fas fa-link"></i></a>
</h3>
<p>In its most basic form, R can be used as a simple calculator. Consider the following arithmetic operators:</p>
<ul>
<li>Addition: <code>+</code>
</li>
<li>Subtraction: <code>-</code>
</li>
<li>Multiplication: <code>*</code>
</li>
<li>Division: <code>/</code>
</li>
<li>Exponentiation: <code>^</code>
</li>
<li>Modulo: <code>%%</code>
</li>
</ul>
<p>The last two might need some explaining:</p>
<p>The ^ operator raises the number to its left to the power of the number to its right: for example <code>3^2</code> is 9.</p>
<p>The modulo returns the remainder of the division of the number to the left by the number on its right, for example 5 modulo 3 (or <code>5 %% 3</code>) is 2.</p>
<p><strong>Try on your computer:</strong></p>
<ul>
<li>Type 2^5 in the editor to calculate 2 to the power of 5.</li>
<li>Type 28 %% 6 to calculate 28 modulo 6.</li>
</ul>
</div>
<div id="variable-assignment" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> Variable assignment<a class="anchor" aria-label="anchor" href="#variable-assignment"><i class="fas fa-link"></i></a>
</h3>
<p>A basic concept in programming (statistical or not) is called a <em>variable</em>.</p>
<p>A variable allows you to store a value (e.g. 2) or an object (e.g. a function description) in R. You can then later use this variable’s name to easily access the value or the object that is stored within this variable.</p>
<p>You can assign a value <code>2</code> to a variable <code>my_var</code> with the command</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_var</span> <span class="op">&lt;-</span> <span class="fl">2</span></code></pre></div>
<p>Note that you would have obtained the same result using:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">2</span> <span class="op">-&gt;</span> <span class="va">my_var</span></code></pre></div>
<p>that is, the <em>assignment operator</em> works in both directions <code>&lt;-</code> and <code>-&gt;</code>.</p>
<p>The variable can then be used in any computation, for example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my_var</span> <span class="op">+</span> <span class="fl">2</span> 
<span class="co">#&gt; [1] 4</span></code></pre></div>
<p><strong>Try on your computer:</strong></p>
<ul>
<li>Assigns the value 42 to the variable x in the editor, then print out its value.</li>
<li>Suppose you have a fruit basket with five apples. As a data analyst, you want to store the number of apples in a variable with the name <code>my_apples</code>.</li>
<li>You decide to add six oranges to your fruit basket. Create the variable <code>my_oranges</code> and assign the value 6 to it. Next, you want to calculate how many pieces of fruit you have in total. Since you have given meaningful names to these values, you can now code this in a clear way by typing <code>my_apples + my_oranges</code>
</li>
<li>Assign the result of adding <code>my_apples</code> and <code>my_oranges</code> to a new variable <code>my_fruit</code>
</li>
</ul>
</div>
<div id="basic-data-types-in-r" class="section level3" number="3.2.3">
<h3>
<span class="header-section-number">3.2.3</span> Basic data types in R<a class="anchor" aria-label="anchor" href="#basic-data-types-in-r"><i class="fas fa-link"></i></a>
</h3>
<p>Despite common knowledge we just added apples and oranges. The <code>my_apples</code> and <code>my_oranges</code> variables both contained a number (a numerical value) in the previous exercise. The <code>+</code> operator works with numeric variables in R. If you really tried to add “apples” and “oranges,” and assigned a <em>text value</em> to the variable my_oranges, you would be trying to assign the addition of a numeric and a character variable to the variable <code>my_fruit</code>. This is not possible, and R will give you an error message.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Assign a value to the variable my_apples</span>
<span class="va">my_apples</span> <span class="op">&lt;-</span> <span class="fl">5</span> 

<span class="co"># Assign a text value</span>
<span class="va">my_oranges</span> <span class="op">&lt;-</span> <span class="st">"six"</span> 

<span class="co">#</span>
<span class="va">my_fruit</span> <span class="op">&lt;-</span> <span class="va">my_apples</span> <span class="op">+</span> <span class="va">my_oranges</span> 
<span class="co">#&gt; Error in my_apples + my_oranges: non-numeric argument to binary operator</span></code></pre></div>
<p>In fact R works with numerous data types, and some of these are not numerical (so they can’t be added, subtracted, etc.). Some of the most basic types to get started are:</p>
<ul>
<li>Decimal values like 4.5 are called numerics.</li>
<li>Natural numbers like 4 are called integers. Integers are also numerics.</li>
<li>Boolean values (<code>TRUE</code> or <code>FALSE</code>, abbreviated <code>T</code> and <code>F</code>) are called logical<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Note that you can add or multiply logical Boolean values: internally &lt;code&gt;FALSE&lt;/code&gt; are treated as zeroes, and &lt;code&gt;TRUE&lt;/code&gt; as ones.&lt;/p&gt;"><sup>1</sup></a>.</li>
<li>Text (or string) values are called characters.</li>
</ul>
<p><strong>Try on your computer:</strong></p>
<ul>
<li>Assign <code>my_numeric</code> variable to <code>42</code>.</li>
<li>Assign <code>my_character</code> variable to “universe.” (Note that the quotation marks indicate that “universe” is a character.)</li>
<li>Assign <code>my_logical</code> variable to <code>FALSE</code>. (Note that R is case sensitive!)</li>
</ul>
<hr>
<p><span class="math display">\[\\[1in]\]</span></p>
</div>
</div>
<div id="resources-for-learning-r" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Resources for learning R<a class="anchor" aria-label="anchor" href="#resources-for-learning-r"><i class="fas fa-link"></i></a>
</h2>
<p>There is plenty of resources on the web to learn R. I will recommend a couple that I think are particularly well-done and useful:</p>
<ul>
<li><a href="https://swcarpentry.github.io/r-novice-gapminder/">Software Carpentry tutorials on R for Reproducible Scientific Analysis</a></li>
<li>The free book <a href="https://learningstatisticswithr.com/">Learning Statistics with R</a> by <a href="https://djnavarro.net/">Danielle Navarro</a>
</li>
</ul>
<hr>
<p><span class="math display">\[\\[1in]\]</span></p>
</div>
<div id="examples" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Examples<a class="anchor" aria-label="anchor" href="#examples"><i class="fas fa-link"></i></a>
</h2>
<div id="simple-linear-regression-how-old-is-the-universe" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Simple linear regression: <em>How old is the universe?</em><a class="anchor" aria-label="anchor" href="#simple-linear-regression-how-old-is-the-universe"><i class="fas fa-link"></i></a>
</h3>
<p>In this example<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Taken from Simon Wood’s book on GAM&lt;span class="citation"&gt; (Simon Wood, &lt;em&gt;Generalized Additive Models: An Introduction with r&lt;/em&gt;, 2nd ed. (Chapman &amp;amp; Hall/CRC Press, 2017), &lt;a href="https://doi.org/10.1201/9781315370279" role="doc-biblioref"&gt;https://doi.org/10.1201/9781315370279&lt;/a&gt;)&lt;/span&gt;.&lt;/p&gt;'><sup>2</sup></a> we will see how to import data into R and perform a simple linear regression analysis.</p>
<p>According to the standard big-bang model, the universe expands uniformly and locally, according to Hubble’s law
<span class="math display">\[
\text{velocity} = \beta \times \text{distance}
\]</span>
where <span class="math inline">\(\text{velocity}\)</span> and <span class="math inline">\(\text{distance}\)</span> are the relative velocity and distance of a galaxy, respectively; and <span class="math inline">\(\beta\)</span> is “Hubble’s constant.” Note that this is a simple linear equation, in which <span class="math inline">\(\beta\)</span> indicate how much the variable <span class="math inline">\(\text{velocity}\)</span> changes for each unitary increase in the variable <span class="math inline">\(\text{distance}\)</span>.</p>
<p>According to this model <span class="math inline">\(\beta^{-1}\)</span> gives the approximate age of the universe, but <span class="math inline">\(\beta\)</span> is unknown and must somehow be estimated from observations of <span class="math inline">\(\text{velocity}\)</span> and <span class="math inline">\(\text{distance}\)</span>, made for a variety of galaxies at different distances from us. Luckily we have available data from the Hubble Space Telescope. Velocities are assessed by measuring the Doppler effect red shift in the spectrum of light that we receive from the Galaxies. Distance is estimated more indirectly, by using the discovery that in certain class of stars (Cepheids), which display fluctuations in diameter and temperature over a stable period, there is a systematic relationship between the period and their luminosity.</p>
<p>We can load a dataset of measurements from the Hubble Space Telescope in R using the following code</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"https://raw.githubusercontent.com/mattelisi/RHUL-stats/main/data/hubble.txt"</span>, 
                header<span class="op">=</span><span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><code>read.table</code> is a generic function to import dataset in text files (e.g. .csv files) into R. We use the argument <code>header=T</code> to specify that the first line of the dataset gives the names of the columns. Note that the argument <code>file</code> here is a URL, but it could be also a path to a file in our local folder. To see the help of this function, and what other arguments and features are available type <code><a href="https://rdrr.io/r/utils/read.table.html">?read.table</a></code> in the R command line.</p>
<p>We can use the command <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> to examine what we have imported</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    24 obs. of  3 variables:</span>
<span class="co">#&gt;  $ Galaxy  : chr  "NGC0300" "NGC0925" "NGC1326A" "NGC1365" ...</span>
<span class="co">#&gt;  $ velocity: int  133 664 1794 1594 1473 278 714 882 80 772 ...</span>
<span class="co">#&gt;  $ distance: num  2 9.16 16.14 17.95 21.88 ...</span></code></pre></div>
<p>This tells us that our data frame has 3 variables:</p>
<ul>
<li>
<code>Galaxy</code>, the ‘names’ of the galaxies in the dataset</li>
<li>
<code>velocity</code>, their relative velocity in Km/sec</li>
<li>
<code>distance</code>, their distance expressed in Mega-parsecs<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;span class="math inline"&gt;\(1 \text{Mega-parsec} = 3.09 \times 10^{19} \text{Km}\)&lt;/span&gt;&lt;/p&gt;'><sup>3</sup></a>
</li>
</ul>
<p>We can plot<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;See &lt;code&gt;?plot&lt;/code&gt; for more info about how to customize plots in R.&lt;/p&gt;"><sup>4</sup></a> them using the following code:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">distance</span>, <span class="co"># indicate which variable on X axis</span>
     <span class="va">d</span><span class="op">$</span><span class="va">velocity</span>, <span class="co"># indicate which variable on Y axis</span>
     xlab<span class="op">=</span><span class="st">"Distance [Mega-parsecs]"</span>,
     ylab<span class="op">=</span><span class="st">"Velocity [Km/sec]"</span>, 
     pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span> <span class="co"># set the type of point</span></code></pre></div>
<div class="inline-figure"><img src="02-intro-R_files/figure-html/unnamed-chunk-9-1.png" width="384" style="display: block; margin: auto;"></div>
<p>It is clear, from the figure, that the observed data do not follow Hubble’s law exactly, but given the how these measurements were obtained (there is uncertainty about the true values of the distance and velocities) it would be surprising if they did. Given the apparent variability, what can be inferred from these data?
In particular:</p>
<ol style="list-style-type: decimal">
<li>what value of <span class="math inline">\(\beta\)</span> is most consistent with the data?</li>
<li>what range of <span class="math inline">\(\beta\)</span> values is consistent with the data?</li>
</ol>
<p>In order to make inferences we make some assumptions about the nature of the measurement noise. Specifically, we assume that measurements errors are well-characterized by a Gaussian distribution. This result in the following model:
<span class="math display">\[\begin{align*}
y &amp;= \beta x + \epsilon \\
\epsilon &amp;\sim \mathcal{N} \left(0, \sigma_{\epsilon}^2 \right)
\end{align*}\]</span>
which is essentially a linear regression but without the intercept.</p>
<p>We can fit the model with the function <code>lm</code> in R.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hub.m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">velocity</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">distance</span>, <span class="va">d</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">hub.m</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = velocity ~ 0 + distance, data = d)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;    Min     1Q Median     3Q    Max </span>
<span class="co">#&gt; -736.5 -132.5  -19.0  172.2  558.0 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;          Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; distance   76.581      3.965   19.32 1.03e-15 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  </span>
<span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 258.9 on 23 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.9419, Adjusted R-squared:  0.9394 </span>
<span class="co">#&gt; F-statistic: 373.1 on 1 and 23 DF,  p-value: 1.032e-15</span></code></pre></div>
<p>So, based on this data, <strong>our estimate of the Hubble constant is 76.58 with a standard error of 3.96.</strong> The standard error - which is the standard deviation of the sampling distribution of our estimates - gives an ideas of the range of values that is compatible with our data and could be used to compute a confidence intervals.</p>
<div class="rmdnote">
<p><em>So, how old?</em></p>
<p>The Hubble constant estimate have units of <span class="math inline">\(\frac{\text{Km}/\text{sec}}{\text{Mega-parsecs}}\)</span>. A Mega-parsecs is <span class="math inline">\(3.09 \times 10^{19} \text{Km}\)</span>, so we divide our estimate of <span class="math inline">\(\hat \beta\)</span> by this amount. The reciprocal of <span class="math inline">\(\hat \beta\)</span> then gives the approximate age of the universe (in seconds). In R we can calculate it (in years) as follow</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># transform in Km</span>
<span class="va">hubble.const</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">hub.m</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">3.09</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fl">19</span><span class="op">)</span><span class="op">)</span>

<span class="co"># invert to get age in seconds</span>
<span class="va">age</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">hubble.const</span>

<span class="co"># use unname() to avoid carrying over </span>
<span class="co"># the label "distance" from the model</span>
<span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>

<span class="co"># transform age in years</span>
<span class="va">age</span> <span class="op">&lt;-</span> <span class="va">age</span><span class="op">/</span><span class="op">(</span><span class="fl">60</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">24</span> <span class="op">*</span> <span class="fl">365</span><span class="op">)</span>

<span class="co"># age in billion years</span>
<span class="va">age</span><span class="op">/</span><span class="fl">10</span><span class="op">^</span><span class="fl">9</span>
<span class="co">#&gt; [1] 12.79469</span></code></pre></div>
<p>giving an estimate of about 13 billion years.</p>
</div>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="surveys.html"><span class="header-section-number">2</span> Departmental survey about statistical methods</a></div>
<div class="next"><a href="meta-analysis.html"><span class="header-section-number">4</span> Meta-analyses</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#intro-R"><span class="header-section-number">3</span> Introduction to R</a></li>
<li><a class="nav-link" href="#installing-r"><span class="header-section-number">3.1</span> Installing R</a></li>
<li>
<a class="nav-link" href="#first-steps"><span class="header-section-number">3.2</span> First steps</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#arithmetic-with-r"><span class="header-section-number">3.2.1</span> Arithmetic with R</a></li>
<li><a class="nav-link" href="#variable-assignment"><span class="header-section-number">3.2.2</span> Variable assignment</a></li>
<li><a class="nav-link" href="#basic-data-types-in-r"><span class="header-section-number">3.2.3</span> Basic data types in R</a></li>
</ul>
</li>
<li><a class="nav-link" href="#resources-for-learning-r"><span class="header-section-number">3.3</span> Resources for learning R</a></li>
<li>
<a class="nav-link" href="#examples"><span class="header-section-number">3.4</span> Examples</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#simple-linear-regression-how-old-is-the-universe"><span class="header-section-number">3.4.1</span> Simple linear regression: How old is the universe?</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mattelisi/RHUL-stats/blob/main/RHUL-stats-notebook/02-intro-R.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mattelisi/RHUL-stats/edit/main/RHUL-stats-notebook/02-intro-R.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>RHUL Psychology
Statistical modelling notebook</strong>" was written by Matteo Lisi. It was last built on 2022-04-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
