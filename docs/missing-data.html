<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 9 Missing data | RHUL Psychology Statistical modelling notebook</title>
<meta name="author" content="Matteo Lisi">
<meta name="description" content="9.1 Types of missing data Following the work of Rubin21, missing data are typically grouped in 3 categories: Missing completely at random (MCAR). This assumes that the probability of being missing...">
<meta name="generator" content="bookdown 0.35 with bs4_book()">
<meta property="og:title" content=" 9 Missing data | RHUL Psychology Statistical modelling notebook">
<meta property="og:type" content="book">
<meta property="og:url" content="https://mlisi.xyz/RHUL-stats/missing-data.html">
<meta property="og:image" content="https://mlisi.xyz/RHUL-stats/images/pop_brain.png">
<meta property="og:description" content="9.1 Types of missing data Following the work of Rubin21, missing data are typically grouped in 3 categories: Missing completely at random (MCAR). This assumes that the probability of being missing...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 9 Missing data | RHUL Psychology Statistical modelling notebook">
<meta name="twitter:description" content="9.1 Types of missing data Following the work of Rubin21, missing data are typically grouped in 3 categories: Missing completely at random (MCAR). This assumes that the probability of being missing...">
<meta name="twitter:image" content="https://mlisi.xyz/RHUL-stats/images/pop_brain.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/clipboard-2.0.6/clipboard.min.js"></script><link href="libs/shareon-1.4.1/shareon.min.css" rel="stylesheet">
<script src="libs/shareon-1.4.1/shareon.min.js"></script><link href="libs/xaringanExtra-shareagain-0.2.6/shareagain.css" rel="stylesheet">
<script src="libs/xaringanExtra-shareagain-0.2.6/shareagain.js"></script><script src="libs/fitvids-2.1.1/fitvids.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">RHUL Psychology
Statistical modelling notebook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li><a class="" href="surveys.html"><span class="header-section-number">2</span> Departmental survey about statistical methods</a></li>
<li><a class="" href="intro-R.html"><span class="header-section-number">3</span> Introduction to R</a></li>
<li><a class="" href="correlation.html"><span class="header-section-number">4</span> Correlations</a></li>
<li><a class="" href="linear-models.html"><span class="header-section-number">5</span> Linear models</a></li>
<li><a class="" href="count-data.html"><span class="header-section-number">6</span> Models for count data</a></li>
<li><a class="" href="ordinal.html"><span class="header-section-number">7</span> Models for ordinal data</a></li>
<li><a class="" href="meta-analysis.html"><span class="header-section-number">8</span> Meta-analyses</a></li>
<li><a class="active" href="missing-data.html"><span class="header-section-number">9</span> Missing data</a></li>
<li><a class="" href="SDT.html"><span class="header-section-number">10</span> Signal Detection Theory</a></li>
<li><a class="" href="workshops.html"><span class="header-section-number">11</span> Workshops</a></li>
<li><a class="" href="useful-links-resources.html"><span class="header-section-number">12</span> Useful links &amp; resources</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mattelisi/RHUL-stats">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="missing-data" class="section level1">
<h1>
<span class="header-section-number"> 9</span> Missing data<a class="anchor" aria-label="anchor" href="#missing-data"><i class="fas fa-link"></i></a>
</h1>
<div id="types-of-missing-data" class="section level2">
<h2>
<span class="header-section-number">9.1</span> Types of missing data<a class="anchor" aria-label="anchor" href="#types-of-missing-data"><i class="fas fa-link"></i></a>
</h2>
<p>Following the work of Rubin<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;DONALD B. RUBIN, “Inference and missing data,” &lt;em&gt;Biometrika&lt;/em&gt; 63, no. 3 (December 1976): 581–92, &lt;a href="https://doi.org/10.1093/biomet/63.3.581"&gt;https://doi.org/10.1093/biomet/63.3.581&lt;/a&gt;.&lt;/p&gt;'><sup>21</sup></a></span>, missing data are typically grouped in 3 categories:</p>
<ul>
<li><p>Missing completely at random (<strong>MCAR</strong>). This assumes that the probability of being missing is the same for all cases; this implies that the mechanisms that causes missingness is not related in any way to the data. For example, say, there’s a known unpredictable error on the server side that prevented recording some responses for some respondents to a survey. As the missingness is entirely independent on the respondents’ characteristics, this would be MCAR. When the data are MCAR we can ignore a lot of the complexities and just do a <em>complete-case</em> analysis (that is, simply exclude incomplete observations from the dataset). A part from possible loss of information, doing a complete case analysis should not introduce bias in the results. In practice, however, it is difficult to establish whether the data are truly MCAR. Ideally, to argue that data are MCAR, one should have a good idea of the mechanisms that caused missigness (more on this below). Formally, data is MCAR if <span class="math display">\[
\Pr(R=0|Y_\mathrm{obs},Y_\mathrm{mis},\psi) = \Pr(R=0|\psi)
\]</span> where <span class="math inline">\(R\)</span> is an indicator variable that is set to 0 for missing data and 1 otherwise; <span class="math inline">\(Y_\mathrm{obs},Y_\mathrm{mis}\)</span> indicate observed and missing data, respectively; and <span class="math inline">\(\psi\)</span> is simply a parameter that determine the overall (fixed) probability of being missing.</p></li>
<li><p>Missing at random (<strong>MAR</strong>). A less strong assumption about missingness is that it is systematically related to the observed but not the unobserved data. For example, data are MAR if in a study male respondents are less likely to complete a survey on depression severity than female respondents - that is, the probability of reaching the end of the survey is related to their sex (fully observed) but not the severity of their symptoms. Formally, data is MAR if <span class="math display">\[
\Pr(R=0|Y_\mathrm{obs},Y_\mathrm{mis},\psi) = \Pr(R=0|Y_\mathrm{obs},\psi)
\]</span> When data are missing at random (MAR) the results of complete case analyses may be biased and a common approach to deal with this is to use imputation. Stef van Buuren has a <a href="https://stefvanbuuren.name/fimd/">freely available online book on this topic</a><span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Stef van Buuren, &lt;em&gt;Flexible Imputation of Missing Data&lt;/em&gt;, 2nd ed. (Chapman &amp;amp; Hall/CRC Press, 2018), &lt;a href="https://stefvanbuuren.name/fimd/"&gt;https://stefvanbuuren.name/fimd/&lt;/a&gt;.&lt;/p&gt;'><sup>22</sup></a></span>. Among other things, it illustrates how to do multiple imputation in R with examples.</p></li>
<li><p>Missing not at random (<strong>MNAR</strong>). This means that the probability of being missing varies for reasons that are unknown to us, and may depends on the missing values themselves. Formally this means that <span class="math inline">\(\Pr(R=0|Y_\mathrm{obs},Y_\mathrm{mis},\psi)\)</span> does not simplify in any way. This case is the most hard to handle: a complete case analyses may or may not be biased, but there is no way of knowing it and we may have to find more information about what caused missingness.</p></li>
</ul>
</div>
<div id="deciding-whether-the-data-are-mcar" class="section level2">
<h2>
<span class="header-section-number">9.2</span> Deciding whether the data are MCAR<a class="anchor" aria-label="anchor" href="#deciding-whether-the-data-are-mcar"><i class="fas fa-link"></i></a>
</h2>
<p>As MCAR is the only scenario in which it is safe to do a complete case analysis, it would seem useful to have way to test this assumption. Some approaches have been proposed to test whether the data are MCAR, but they are not widely used and it’s not clear how useful they are in practice. For example one could run a logistic regression with “missingness” as dependent variable (e.g. an indicator variable set to 1 if data is missing and 0 otherwise), and all other variables as predictors - if the data are MCAR then none of the predictors should predict missingness. A popular alternative, implemented in several software packages is Little’s test<span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Roderick J. A. Little, “A Test of Missing Completely at Random for Multivariate Data with Missing Values,” &lt;em&gt;Journal of the American Statistical Association&lt;/em&gt; 83, no. 404 (1988): 1198–1202, &lt;a href="http://www.jstor.org/stable/2290157"&gt;http://www.jstor.org/stable/2290157&lt;/a&gt;.&lt;/p&gt;'><sup>23</sup></a></span>.</p>
<p>Technically, these approaches can help determine whether the missingness depends on some observed variables (that is, if they are MAR), but strictly speaking cannot exclude missingness due to unobserved variables (MNAR scenario). Nevertheless, if one has good reasons to believe that the data are MCAR, and want to add some statistical test that corroborate this assumption, these could be reasonable tests to do. However, it remains important to also discuss openly possible reasons and mechanisms of missingness, and explain why we deem it a priori plausible that the data are MCAR. In fact, <em>statistical tests alone cannot tell whether data are missing completely at random</em>. The terms MCAR, MAR and MNAR refers to the <em>causal</em> mechanisms that is responsible for missing data and, strictly speaking, causal claims cannot be decided uniquely on the basis of a simple statistical test. If the data “pass” the test it would provide some additional support to the assumption that they are MCAR, but in and of itself the test alone does not fully satisfy the assumptions of MCAR. To see why note that MCAR (as formally defined above) assumes also that there should be no relationship between the missingness on a particular variable and the values of that same variable: but since this is a question about what is missing from the data, it cannot be tested with any quantitative analysis of the available data. Finally, it should be added that as these are null-hypothesis significance test, a failure to reject the null hypothesis does not, in and of itself, provide evidence for the null hypothesis (that the data are MCAR). It may be also that we don’t have enough power to reliably detect the pattern in the missingness.</p>
</div>
<div id="causal-analysis-and-bayesian-imputation" class="section level2">
<h2>
<span class="header-section-number">9.3</span> Causal analysis and Bayesian imputation<a class="anchor" aria-label="anchor" href="#causal-analysis-and-bayesian-imputation"><i class="fas fa-link"></i></a>
</h2>
<p>The best and most principled approach to deal with missingness (at least in my opinion) is to think hard about the causal mechanisms that may determine missingness, and use our assumption about the causal mechanisms to perform a full Bayesian imputation (that is, treating the missing data as parameter and estimating them).</p>
<p>I plan to create and include here a worked example of how to do this; in the meantime interested readers are referred to Chapter 15 (in particular section 15.2) of <a href="https://xcelab.net/rm/statistical-rethinking/">the excellent book by Richard McElreath <em>Statistical Rethinking</em></a><span class="citation"><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Richard McElreath, &lt;em&gt;Statistical Rethinking, a Course in R and Stan&lt;/em&gt;, 2nd ed. (Chapman &amp;amp; Hall/CRC Press, 2020), &lt;a href="https://xcelab.net/rm/statistical-rethinking/"&gt;https://xcelab.net/rm/statistical-rethinking/&lt;/a&gt;.&lt;/p&gt;'><sup>24</sup></a></span> which present a very accessible worked example of how to do this in R.</p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="meta-analysis.html"><span class="header-section-number">8</span> Meta-analyses</a></div>
<div class="next"><a href="SDT.html"><span class="header-section-number">10</span> Signal Detection Theory</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#missing-data"><span class="header-section-number">9</span> Missing data</a></li>
<li><a class="nav-link" href="#types-of-missing-data"><span class="header-section-number">9.1</span> Types of missing data</a></li>
<li><a class="nav-link" href="#deciding-whether-the-data-are-mcar"><span class="header-section-number">9.2</span> Deciding whether the data are MCAR</a></li>
<li><a class="nav-link" href="#causal-analysis-and-bayesian-imputation"><span class="header-section-number">9.3</span> Causal analysis and Bayesian imputation</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mattelisi/RHUL-stats/blob/main/RHUL-stats-notebook/09-missing-data.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mattelisi/RHUL-stats/edit/main/RHUL-stats-notebook/09-missing-data.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>RHUL Psychology
Statistical modelling notebook</strong>" was written by Matteo Lisi. It was last built on 2023-11-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
