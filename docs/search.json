[{"path":"index.html","id":"about","chapter":" 1 About","heading":" 1 About","text":"online book created maintained Matteo Lisi meant shared resource staff students Department Psychology Royal Holloway, University London. contain miscellanous set tutorial, examples, case studies, workshops materials useful material related data analysis modelling. added revised time, based common questions requests receive.\\[\\\\[1in]\\]\nwork progress may contain imprecisions typos. spot please let know matteo.lisi [] rhul.ac.uk.\nmaterials included builds upon draw existing literature statistics modelling. endeavor properly cite existing books papers; author feels given fair acknowledgement, please let know make amend.\n","code":""},{"path":"surveys.html","id":"surveys","chapter":" 2 Departmental survey about statistical methods","heading":" 2 Departmental survey about statistical methods","text":"used anonymous survey ask colleagues questions topics may interesting useful research.","code":""},{"path":"surveys.html","id":"march-2022","chapter":" 2 Departmental survey about statistical methods","heading":"2.1 March 2022","text":"","code":""},{"path":"surveys.html","id":"question-1","chapter":" 2 Departmental survey about statistical methods","heading":"2.1.1 Question 1","text":"first question people indicated topics interests. winner multilevel models, followed closely Bayesian statistics.additional suggestions.topics mentioned comment section:Shiny appsNetwork modellingLongitudinal analysesRandom forestsNeural network","code":"#> [1] \"power analyses using Shiny apps\"                                                         \n#> [2] \"agent-based models\"                                                                      \n#> [3] \"this may be covered in the above, but approaches to analysing experience sampling method\"\n#> [4] \"Methods for longitudinal analyses\"                                                       \n#> [5] \"Network modelling\"                                                                       \n#> [6] \"Neural networks, Markov processes\"                                                       \n#> [7] \"Random forests and related\"                                                              \n#> [8] \"causal modelling using regression models - path models etc\"                              \n#> [9] \"prediction modelling\""},{"path":"surveys.html","id":"question-2","chapter":" 2 Departmental survey about statistical methods","heading":"2.1.2 Question 2","text":"people indicated interest topics related data analysis.things mentioned comments :SPMDockerPython","code":""},{"path":"surveys.html","id":"question-4","chapter":" 2 Departmental survey about statistical methods","heading":"2.1.3 Question 4","text":"question likelihood using different formats support","code":""},{"path":"surveys.html","id":"respondents-status","chapter":" 2 Departmental survey about statistical methods","heading":"2.1.4 Respondents’ status","text":"final questions asked status / career level.","code":""},{"path":"intro-R.html","id":"intro-R","chapter":" 3 Introduction to R","heading":" 3 Introduction to R","text":"practical statistical tutorials recipes book use software R, section provides introduction R uninitiated.\\[\\\\[1in]\\]","code":""},{"path":"intro-R.html","id":"installing-r","chapter":" 3 Introduction to R","heading":"3.1 Installing R","text":"base R system can downloaded following link, provides installers Windows, Mac Linux:https://cran.rstudio.com/addition base R system, useful also R-studio, IDE (Integrated Development Environment) R, provides editor, graphical interface much . can downloaded :https://www.rstudio.com/products/rstudio/download/","code":""},{"path":"intro-R.html","id":"first-steps","chapter":" 3 Introduction to R","heading":"3.2 First steps","text":"R programming language free software environment statistical computing graphics. interpreted language, means give instructions computer compile first machine language, everything done ‘fly’ command line interpreter, e.g. type 2+2 command line R, computer reply answer (try computer):Typically normal workflow involve writing saving series instructions script file (usually saved .R extension), can executed (either step step ). Since steps analyes documented script, makes transparent reproducible.R script can use # sign add comments, others can understand R code . Commented lines ignored R, influence result. See next example:","code":"\n2+2\n#> [1] 4\n# calculate 3 + 4\n3 + 4\n#> [1] 7"},{"path":"intro-R.html","id":"arithmetic-with-r","chapter":" 3 Introduction to R","heading":"3.2.1 Arithmetic with R","text":"basic form, R can used simple calculator. Consider following arithmetic operators:Addition: +Subtraction: -Multiplication: *Division: /Exponentiation: ^Modulo: %%last two might need explaining:^ operator raises number left power number right: example 3^2 9.modulo returns remainder division number left number right, example 5 modulo 3 (5 %% 3) 2.","code":""},{"path":"intro-R.html","id":"variable-assignment","chapter":" 3 Introduction to R","heading":"3.2.2 Variable assignment","text":"basic concept programming (statistical ) called variable.variable allows store value (e.g. 2) object (e.g. function description) R. can later use variable’s name easily access value object stored within variable.can assign value 2 variable my_var commandNote obtained result using:, assignment operator works directions <- ->.variable can used computation, example:","code":"\nmy_var <- 2\n2 -> my_var\nmy_var + 2 \n#> [1] 4"},{"path":"intro-R.html","id":"basic-data-types-in-r","chapter":" 3 Introduction to R","heading":"3.2.3 Basic data types in R","text":"Variables can many types, just numerical values. example, can contain text values (e.g. string characters). Arithmetic operators + work . tried apply characters R give error message.fact R works numerous data types, numerical (can’t added, subtracted, etc.). basic types get started :Decimal values like 4.5 called numerics.Natural numbers like 4 called integers. Integers also numerics.Boolean values (TRUE FALSE, abbreviated T F) called logical1.Text (string) values called characters.","code":"\n# Assign a value to the variable apples\napples <- 5 \n\n# Assign a text value\noranges <- \"six\" \n\n#  \napples + oranges \n#> Error in apples + oranges: non-numeric argument to binary operator"},{"path":"intro-R.html","id":"vectors-and-other-data-types","chapter":" 3 Introduction to R","heading":"3.2.4 Vectors and other data types","text":"Additionally, simple data types listed can combined complex ‘objects’ can comprise several values. example, can obtain vector concatenating values using function c(). can applied numerical character data types, e.g. special handy functions create specific types vectors, sequences (using function seq() operator :)Another useful type vector can obtained repetition elements, can numerical, character, even applied vectorsWe can combine vectors different types data frame, one useful ways storing data R. Let’s say 3 vectors:can combine data.frame using:Although note cases probably import dataframe external data file, example using functions read.table read.csv.","code":"\nsome_numbers <- c(4,87,10, 0.5, -6)\nsome_numbers\n#> [1]  4.0 87.0 10.0  0.5 -6.0\n\nmy_modules <- c(\"PS115\", \"PS509\", \"PS300\", \"PS938\", \"PS9457\")\nmy_modules\n#> [1] \"PS115\"  \"PS509\"  \"PS300\"  \"PS938\"  \"PS9457\"\nx <- seq(from = -10, to = 10, by = 2)\nx\n#>  [1] -10  -8  -6  -4  -2   0   2   4   6   8  10\n\ny <- seq(-0, 1, 0.1)\ny\n#>  [1] 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0\n\nz <- 1:5\nz\n#> [1] 1 2 3 4 5\nrep(3, 5)\n#> [1] 3 3 3 3 3\n\nx <- 1:3\nrep(x, 4)\n#>  [1] 1 2 3 1 2 3 1 2 3 1 2 3\n\nrep(c(\"leo the cat\", \"daisy the dog\"), 2)\n#> [1] \"leo the cat\"   \"daisy the dog\" \"leo the cat\"  \n#> [4] \"daisy the dog\"\n# create a numeric vector \na <- c(0, NA, 2:4)  # NA means not available\n\n# create a character vector\nb <-  c(\"PS115\", \"PS509\", \"PS300\", \"PS938\", \"PS9457\")\n\n# create a logical vector\nc <- c(TRUE, FALSE, TRUE, FALSE, FALSE)  # must all be caps!\n# create a data frame with the vectors a, b,and c that we just created\nmy_dataframe <- data.frame(a,b,c)\n\n# we could also change the column names (currently they are a, b, c)\ncolnames(my_dataframe) <- c(\"some_numbers\", \"my_modules\", \"logical_values\")\n\n# now let's have a look at it\nmy_dataframe\n#>   some_numbers my_modules logical_values\n#> 1            0      PS115           TRUE\n#> 2           NA      PS509          FALSE\n#> 3            2      PS300           TRUE\n#> 4            3      PS938          FALSE\n#> 5            4     PS9457          FALSE"},{"path":"intro-R.html","id":"basic-plotting-in-r","chapter":" 3 Introduction to R","heading":"3.2.5 Basic plotting in R","text":"can create plots using function plot(). example:","code":"\nx = 1:10\ny = 3*x - 5\nplot(x, y)"},{"path":"intro-R.html","id":"other-operations","chapter":" 3 Introduction to R","heading":"3.2.6 Other operations","text":"","code":""},{"path":"intro-R.html","id":"random-number-generation","chapter":" 3 Introduction to R","heading":"3.2.6.1 Random number generation","text":"Generate uniformly distributed random numbers (function runif())Generate numbers normal distribution","code":"\nx <- runif(100, min = 0, max = 1)\nhist(x)\ny <- rnorm(100, mean = 0, sd = 1)\nhist(y)"},{"path":"intro-R.html","id":"getting-help","chapter":" 3 Introduction to R","heading":"3.2.7 Getting help","text":"R lot functions, extra packages can provides even . may seem bit overwhelming, easy get help use function: just type question mark, followed name function. example, see help function used generate histogram, type\\[\\\\[1in]\\]","code":"\n?hist"},{"path":"intro-R.html","id":"resources-for-learning-r","chapter":" 3 Introduction to R","heading":"3.3 Resources for learning R","text":"plenty resources web learn R. recommend couple think particularly well-done useful:Software Carpentry tutorials R Reproducible Scientific AnalysisThe free book Learning Statistics R Danielle Navarro","code":""},{"path":"linear-models.html","id":"linear-models","chapter":" 4 Linear models","heading":" 4 Linear models","text":"section provide worked examples analyses R.","code":""},{"path":"linear-models.html","id":"simple-linear-regression","chapter":" 4 Linear models","heading":"4.0.1 Simple linear regression","text":"example2 see import data R perform simple linear regression analysis.According standard big-bang model, universe expands uniformly locally, according Hubble’s law3\n\\[\n\\text{velocity} = \\beta \\times \\text{distance}\n\\]\n\\(\\text{velocity}\\) \\(\\text{distance}\\) relative velocity distance galaxy, respectively; \\(\\beta\\) “Hubble’s constant”4. Note simple linear equation, \\(\\beta\\) indicate much variable \\(\\text{velocity}\\) changes unitary increase variable \\(\\text{distance}\\).According model \\(\\beta^{-1}\\) gives approximate age universe, \\(\\beta\\) unknown must somehow estimated observations \\(\\text{velocity}\\) \\(\\text{distance}\\), made variety galaxies different distances us. Luckily available data Hubble Space Telescope. Velocities assessed measuring Doppler effect red shift spectrum light receive Galaxies. Distance estimated indirectly, using discovery certain class stars (Cepheids), display fluctuations diameter temperature stable period, systematic relationship period luminosity.can load dataset measurements Hubble Space Telescope R using following coderead.table generic function import dataset text files (e.g. .csv files) R. use argument header=T specify first line dataset gives names columns. Note argument file URL, also path file local folder. see help function, arguments features available type ?read.table R command line.can use command str() examine importedThis tells us data frame 3 variables:Galaxy, ‘names’ galaxies datasetvelocity, relative velocity Km/secdistance, distance expressed Mega-parsecs5We can plot6 using following code:clear, figure, observed data follow Hubble’s law exactly, given measurements obtained (uncertainty true values distance velocities) surprising . Given apparent variability, can inferred data?\nparticular:value \\(\\beta\\) consistent data?range \\(\\beta\\) values consistent data?order make inferences make assumptions nature measurement noise. Specifically, assume measurements errors well-characterized Gaussian distribution. result following model:\n\\[\\begin{align*}\ny &= \\beta x + \\epsilon \\\\\n\\epsilon &\\sim \\mathcal{N} \\left(0, \\sigma_{\\epsilon}^2 \\right)\n\\end{align*}\\]\nessentially linear regression without intercept: , whereas normally linear regression model include additive term multiplied predictor (\\(y = \\beta_0 + \\beta_1 x + \\epsilon\\)), gives expected value dependent variable predictors set zero, case theory tells us can assume intercept (term \\(\\beta_0\\)) zero can ignore .can fit model function lm R. Note tell R don’t want fit intercept, include formula term 0 + - essentially tells R intercept term set zero7So, based data, estimate Hubble constant 76.58 standard error 3.96. standard error - standard deviation sampling distribution estimates - gives ideas range values compatible data used compute confidence intervals (roughly, expect ‘true’ values parameters lies interval defined \\(\\pm\\) 2 standard errors 95% times)., old universe?Hubble constant estimate units \\(\\frac{\\text{Km}/\\text{sec}}{\\text{Mega-parsecs}}\\). Mega-parsecs \\(3.09 \\times 10^{19} \\text{Km}\\), divide estimate \\(\\hat \\beta\\) amount. reciprocal \\(\\hat \\beta\\) gives approximate age universe (seconds). R can calculate (years) followgiving estimate 13 billion years.","code":"\nd <- read.table(file=\"https://raw.githubusercontent.com/mattelisi/RHUL-stats/main/data/hubble.txt\", \n                header=T)\nstr(d)\n#> 'data.frame':    24 obs. of  3 variables:\n#>  $ Galaxy  : chr  \"NGC0300\" \"NGC0925\" \"NGC1326A\" \"NGC1365\" ...\n#>  $ velocity: int  133 664 1794 1594 1473 278 714 882 80 772 ...\n#>  $ distance: num  2 9.16 16.14 17.95 21.88 ...\nplot(d$distance, # indicate which variable on X axis\n     d$velocity, # indicate which variable on Y axis\n     xlab=\"Distance [Mega-parsecs]\",\n     ylab=\"Velocity [Km/sec]\", \n     pch=19) # set the type of point\nhub.m <- lm(velocity ~ 0 + distance, d)\nsummary(hub.m)\n#> \n#> Call:\n#> lm(formula = velocity ~ 0 + distance, data = d)\n#> \n#> Residuals:\n#>    Min     1Q Median     3Q    Max \n#> -736.5 -132.5  -19.0  172.2  558.0 \n#> \n#> Coefficients:\n#>          Estimate Std. Error t value Pr(>|t|)    \n#> distance   76.581      3.965   19.32 1.03e-15 ***\n#> ---\n#> Signif. codes:  \n#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 258.9 on 23 degrees of freedom\n#> Multiple R-squared:  0.9419, Adjusted R-squared:  0.9394 \n#> F-statistic: 373.1 on 1 and 23 DF,  p-value: 1.032e-15\n# transform in Km\nhubble.const <- coef(hub.m)/(3.09 * 10^(19))\n\n# invert to get age in seconds\nage <- 1/hubble.const\n\n# use unname() to avoid carrying over \n# the label \"distance\" from the model\nage <- unname(age)\n\n# transform age in years\nage <- age/(60^2 * 24 * 365)\n\n# age in billion years\nage/10^9\n#> [1] 12.79469"},{"path":"meta-analysis.html","id":"meta-analysis","chapter":" 5 Meta-analyses","heading":" 5 Meta-analyses","text":"running meta-analyses, recommend metafor package R (see link 1, link 2).comprehensive, hands-guide use package provided book Harrer colleagues,8 freely available link.alternative metafor package Bayesian multilevel modelling (also discussed book Harrer colleagues). technical discussion Bayesian multilevel modelling meta-analyes provided paper Williams, Rast Bürkner.9","code":""},{"path":"missing-data.html","id":"missing-data","chapter":" 6 Missing data","heading":" 6 Missing data","text":"","code":""},{"path":"missing-data.html","id":"types-of-missing-data","chapter":" 6 Missing data","heading":"6.1 Types of missing data","text":"Following work Rubin,10 missing data typically grouped 3 categories:Missing completely random (MCAR). assumes probability missing cases; implies mechanisms causes missingness related way data. example, say, ’s known unpredictable error server side prevented recording responses respondents survey. missingness entirely independent respondents’ characteristics, MCAR. data MCAR can ignore lot complexities just complete-case analysis (, simply exclude incomplete observations dataset). part possible loss information, complete case analysis introduce bias results. practice, however, difficult establish whether data truly MCAR. Ideally, argue data MCAR, one good idea mechanisms caused missigness (). Formally, data MCAR \\[\n\\Pr(R=0|Y_\\mathrm{obs},Y_\\mathrm{mis},\\psi) = \\Pr(R=0|\\psi)\n\\] \\(R\\) indicator variable set 0 missing data 1 otherwise; \\(Y_\\mathrm{obs},Y_\\mathrm{mis}\\) indicate observed missing data, respectively; \\(\\psi\\) simply parameter determine overall (fixed) probability missing.Missing completely random (MCAR). assumes probability missing cases; implies mechanisms causes missingness related way data. example, say, ’s known unpredictable error server side prevented recording responses respondents survey. missingness entirely independent respondents’ characteristics, MCAR. data MCAR can ignore lot complexities just complete-case analysis (, simply exclude incomplete observations dataset). part possible loss information, complete case analysis introduce bias results. practice, however, difficult establish whether data truly MCAR. Ideally, argue data MCAR, one good idea mechanisms caused missigness (). Formally, data MCAR \\[\n\\Pr(R=0|Y_\\mathrm{obs},Y_\\mathrm{mis},\\psi) = \\Pr(R=0|\\psi)\n\\] \\(R\\) indicator variable set 0 missing data 1 otherwise; \\(Y_\\mathrm{obs},Y_\\mathrm{mis}\\) indicate observed missing data, respectively; \\(\\psi\\) simply parameter determine overall (fixed) probability missing.Missing random (MAR). less strong assumption missingness systematically related observed unobserved data. example, data MAR study male respondents less likely complete survey depression severity female respondents - , probability reaching end survey related sex (fully observed) severity symptoms. Formally, data MAR \\[\n\\Pr(R=0|Y_\\mathrm{obs},Y_\\mathrm{mis},\\psi) = \\Pr(R=0|Y_\\mathrm{obs},\\psi)\n\\] data missing random (MAR) results complete case analyses may biased common approach deal use imputation. Stef van Buuren freely available online book topic.11 Among things, illustrates multiple imputation R examples.Missing random (MAR). less strong assumption missingness systematically related observed unobserved data. example, data MAR study male respondents less likely complete survey depression severity female respondents - , probability reaching end survey related sex (fully observed) severity symptoms. Formally, data MAR \\[\n\\Pr(R=0|Y_\\mathrm{obs},Y_\\mathrm{mis},\\psi) = \\Pr(R=0|Y_\\mathrm{obs},\\psi)\n\\] data missing random (MAR) results complete case analyses may biased common approach deal use imputation. Stef van Buuren freely available online book topic.11 Among things, illustrates multiple imputation R examples.Missing random (MNAR). means probability missing varies reasons unknown us, may depends missing values . Formally means \\(\\Pr(R=0|Y_\\mathrm{obs},Y_\\mathrm{mis},\\psi)\\) simplify way. case hard handle: complete case analyses may may biased, way knowing may find information caused missingness.Missing random (MNAR). means probability missing varies reasons unknown us, may depends missing values . Formally means \\(\\Pr(R=0|Y_\\mathrm{obs},Y_\\mathrm{mis},\\psi)\\) simplify way. case hard handle: complete case analyses may may biased, way knowing may find information caused missingness.","code":""},{"path":"missing-data.html","id":"deciding-whether-the-data-are-mcar","chapter":" 6 Missing data","heading":"6.2 Deciding whether the data are MCAR","text":"MCAR scenario safe complete case analysis, seem useful way test assumption. approaches proposed test whether data MCAR, widely used ’s clear useful practice. example one run logistic regression “missingness” dependent variable (e.g. indicator variable set 1 data missing 0 otherwise), variables predictors - data MCAR none predictors predict missingness. popular alternative, implemented several software packages Little’s test.12Technically, approaches can help determine whether missingness depends observed variables (, MAR), strictly speaking exclude missingness due unobserved variables (MNAR scenario). Nevertheless, one good reasons believe data MCAR, want add statistical test corroborate assumption, reasonable tests . However, remains important also discuss openly possible reasons mechanisms missingness, explain deem priori plausible data MCAR. fact, statistical tests alone tell whether data missing completely random. terms MCAR, MAR MNAR refers causal mechanisms responsible missing data , strictly speaking, causal claims decided uniquely basis simple statistical test. data “pass” test provide additional support assumption MCAR, test alone fully satisfy assumptions MCAR. see note MCAR (formally defined ) assumes also relationship missingness particular variable values variable: since question missing data, tested quantitative analysis available data. Finally, added null-hypothesis significance test, failure reject null hypothesis , , provide evidence null hypothesis (data MCAR). may also don’t enough power reliably detect pattern missingness.","code":""},{"path":"missing-data.html","id":"causal-analysis-and-bayesian-imputation","chapter":" 6 Missing data","heading":"6.3 Causal analysis and Bayesian imputation","text":"best principled approach deal missingness (least opinion) think hard causal mechanisms may determine missingness, use assumption causal mechanisms perform full Bayesian imputation (, treating missing data parameter estimating ).plan create include worked example ; meantime interested readers referred Chapter 15 (particular section 15.2) excellent book Richard McElreath Statistical Rethinking13 present accessible worked example R.","code":""},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
